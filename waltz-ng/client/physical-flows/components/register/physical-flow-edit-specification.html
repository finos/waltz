<div class="waltz-physical-flow-edit-specification">
    <div class="wpfes-table">

        <!-- HEADER -->
        <div class="row wpfes-header">
            <div class="col-md-3">Name</div>
            <div class="col-md-2">External Id</div>
            <div class="col-md-2">Format</div>
            <div class="col-md-5">Description</div>
        </div>


        <!-- EXISTING -->
        <div class="row wpfes-existing-row"
             ng-repeat="candidate in $ctrl.candidates | orderBy:'name'"
             ng-class="{
                'wpfes-current': candidate.id == $ctrl.current.id,
                'wpfes-selected': candidate.id == $ctrl.selected.id
             }"
             ng-click="$ctrl.select(candidate)">
            <div class="col-md-3"><span ng-bind="candidate.name"></span></div>
            <div class="col-md-2"><span ng-bind="candidate.externalId"></span></div>
            <div class="col-md-2"><span ng-bind="candidate.format"></span></div>
            <div class="col-md-5"><span ng-bind="candidate.description"></span></div>
        </div>


        <!-- ADD BUTTON -->
        <div class='row'
             ng-if="$ctrl.visibility.showAddButton">
            <div class="col-md-3">
                <a ng-click='$ctrl.showAddNewForm()'
                   class="clickable">
                    <waltz-icon name="plus"></waltz-icon>
                    Add new
                </a>
            </div>
        </div>


        <!-- ADD FORM -->
        <div ng-if="!$ctrl.visibility.showAddButton"
             class="wpfes-addNewForm">

            <!-- ADD FORM FIELDS -->

            <div class="row">

                <div class="col-md-3">
                    <input type="text"
                           ng-model="$ctrl.form.name"
                           ng-change="$ctrl.validateForm()"
                           required="required"
                           placeholder="Name"
                           class="form-control input-sm">
                </div>
                <div class="col-md-2">
                    <input type="text"
                           name="externalId"
                           ng-model="$ctrl.form.externalId"
                           placeholder="External Id"
                           class="form-control input-sm">
                </div>
                <div class="col-md-2">
                    <select ng-model="$ctrl.form.format"
                            ng-change="$ctrl.validateForm()"
                            name="format">
                        <option value="BINARY">Binary</option>
                        <option value="DATABASE">Database</option>
                        <option value="FLAT_FILE">Flat File</option>
                        <option value="JSON">JSON</option>
                        <option value="UNSTRUCTURED">Unstructured</option>
                        <option value="XML">XML</option>
                    </select>
                </div>
                <div class="col-md-5">
                    <textarea rows="4"
                              name="description"
                              ng-model="$ctrl.form.description"
                              placeholder="Description"
                              class="form-control input-sm">
                    </textarea>
                </div>
            </div>

        </div>

    </div>


    <hr>

    <div ng-if="!$ctrl.visibility.showAddButton">
        <div class="row">
            <div class="col-md-offset-8 col-md-4">
                <button type="submit"
                        class="btn btn-sm btn-primary"
                        ng-click="$ctrl.doAddNew()"
                        ng-disabled="! $ctrl.validation.canSubmit">
                    <waltz-icon name="check"></waltz-icon>
                    Add and select
                </button>
                &nbsp;
                <a class='clickable'
                   ng-click="$ctrl.cancelAddNew()">
                    Cancel
                </a>

                <div ng-if="$ctrl.validation.message"
                     class="wpfes-error"
                     ng-bind="$ctrl.validation.message">
                </div>
            </div>
        </div>

    </div>

    <div ng-if="$ctrl.visibility.showAddButton">
        <div class="row">
            <div class="col-md-offset-8 col-md-4">
                <button ng-click='$ctrl.change()'
                        ng-disabled="!$ctrl.visibility.showAddButton"
                        class="btn btn-sm btn-primary">
                    Select
                </button>

                <a class="clickable"

                   ng-click="$ctrl.cancel()">
                    Cancel
                </a>
            </div>
        </div>
    </div>


</div>