<div class="waltz-entity-named-notes">    <a class="clickable"       ng-if="! $ctrl.visibility.notes && $ctrl.notes.length > 0"       ng-click="$ctrl.showNotes()">        &raquo;        <span ng-bind="$ctrl.labelText"></span>    </a>    <div ng-if="$ctrl.visibility.notes || $ctrl.creatingNote">        <table class="wenn-table small table table-condensed table-striped">            <colgroup>                <col width="30%">                <col width="70%">                <col width="20%">            </colgroup>            <thead>            <tr>                <th>Note Type</th>                <th>Note Text</th>                <th></th>            </tr>            </thead>            <tbody>            <tr ng-repeat="note in $ctrl.notes"                class="waltz-visibility-parent">                <td>                    <div ng-bind="note.namedNoteTypeId | toDisplayName:'entityNamedNoteType'">                    </div>                    <waltz-markdown class="small text-muted"                                    text="note.namedNoteTypeId | toDescription:'entityNamedNoteType'">                    </waltz-markdown>                    <br>                    <div ng-if="! $ctrl.noteTypesById[note.namedNoteTypeId].isReadOnly"                         waltz-has-role="{{ $ctrl.editRole }}">                        <br>                        <a class="clickable"                           ng-click="$ctrl.startEditNote(note)">                            <waltz-icon name="pencil"></waltz-icon>                            Edit                        </a>                        &nbsp;&nbsp;                        <a class="clickable"                           ng-click="$ctrl.deleteNote(note)">                            <waltz-icon name="trash"></waltz-icon>                            Delete                        </a>                    </div>                    <br>                    <waltz-last-updated class="small"                                        entity="note">                    </waltz-last-updated>                    <div ng-if="note.noteText.length > 1500">                        <br>                        <a class="clickable"                           ng-if="! $ctrl.expandedNotes[note.namedNoteTypeId]"                           ng-click="$ctrl.expandNote(note)">                            <waltz-icon name="plus"></waltz-icon>                            Expand                        </a>                        <a class="clickable"                           ng-if="$ctrl.expandedNotes[note.namedNoteTypeId]"                           ng-click="$ctrl.collapseNote(note)">                            <waltz-icon name="minus"></waltz-icon>                            Collapse                        </a>                    </div>                </td>                <td align="left">                    <div ng-class="{ 'waltz-scroll-region-350': note.noteText.length > 1500 && ! $ctrl.expandedNotes[note.namedNoteTypeId] }">                        <textarea class="form-control input-sm"                                  ng-if="$ctrl.editingNotes[note.namedNoteTypeId]"                                  rows="6"                                  placeholder="Markdown is supported"                                  ng-model="$ctrl.editingNotes[note.namedNoteTypeId].noteTextVal">                        </textarea>                        <waltz-markdown ng-if="! $ctrl.editingNotes[note.namedNoteTypeId]"                                        text="note.noteText">                        </waltz-markdown>                    </div>                </td>                <td>                    <div ng-if="$ctrl.editingNotes[note.namedNoteTypeId]">                        <button class="btn btn-success btn-xs"                                ng-disabled="! $ctrl.editingNotes[note.namedNoteTypeId].noteTextVal"                                ng-click="$ctrl.updateNote(note)">                            &nbsp;&nbsp;Save&nbsp;                        </button>                        <br>                        <a class="btn btn-xs"                           ng-click="$ctrl.cancelEditNote(note)">                            Cancel                        </a>                    </div>                </td>            </tr>            <!-- ADD NEW -->            <tr ng-if="$ctrl.creatingNote === true">                <td>                    <select class="form-control input-sm"                            placeholder="Note Type"                            ng-options="noteType.id as noteType.name for noteType in $ctrl.creatableNoteTypes"                            ng-model="$ctrl.newNote.namedNoteTypeId">                    </select>                </td>                <td>                    <textarea class="form-control input-sm"                              rows="6"                              placeholder="Markdown is supported"                              ng-model="$ctrl.newNote.noteText">                    </textarea>                </td>                <td>                    <button class="btn btn-success btn-xs"                            ng-disabled="! $ctrl.newNote.namedNoteTypeId || ! $ctrl.newNote.noteText"                            ng-click="$ctrl.saveNewNote()">                        &nbsp;&nbsp;Save&nbsp;                    </button>                    <br>                    <a class="btn btn-xs"                        ng-click="$ctrl.cancelNewNote()">                        Cancel                    </a>                </td>            </tr>            </tbody>        </table>    </div>    <a class="clickable"       waltz-has-role="{{ $ctrl.editRole }}"       ng-if="$ctrl.creatableNoteTypes.length > 0 && ! $ctrl.creatingNote && ($ctrl.notes.length === 0 || $ctrl.visibility.notes)"       ng-click="$ctrl.startNewNote()">        +Add Note    </a></div>
