<!--
  ~ Waltz - Enterprise Architecture
  ~ Copyright (C) 2016, 2017, 2018, 2019 Waltz open source project
  ~ See README.md for more information
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Lesser General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Lesser General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Lesser General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<div class="row waltz-logical-flows-tabgroup">
    <div class="col-md-12">
        <uib-tabset active="active">
            <uib-tab index="0"
                     heading="Summary"
                     select="$ctrl.tabSelected('summary', 0)">
                <div class="row">
                    <div class="col-sm-4">
                        <br>
                        <waltz-flow-cloud-diagram
                            width="300"
                            height="300"
                            stats="$ctrl.stats">
                        </waltz-flow-cloud-diagram>
                    </div>
                    <div class="col-sm-12 col-md-8">
                        <waltz-logical-flows-data-type-summary-pane
                            stats="$ctrl.stats"
                            parent-entity-ref="$ctrl.parentEntityRef"
                            filters="$ctrl.filters">
                        </waltz-logical-flows-data-type-summary-pane>
                    </div>
                </div>
            </uib-tab>

            <!-- GRAPH -->
            <uib-tab index="1"
                     heading="Graph"
                     select="$ctrl.tabSelected('graph', 1)">
                <br>

                <div ng-if="$ctrl.currentTabIndex == 1">
                    <waltz-logical-flows-boingy-graph parent-entity-ref="$ctrl.parentEntityRef"
                                                      filters="$ctrl.filters">
                    </waltz-logical-flows-boingy-graph>
                </div>

            </uib-tab>

            <!-- TABLE -->
            <uib-tab index="2"
                     heading="Table"
                     select="$ctrl.tabSelected('table', 2)">
                <br>
                <waltz-loading-notification show="$ctrl.visibility.loadingFlows"
                                            name="Loading Flow Data">
                </waltz-loading-notification>
                <div ng-if="$ctrl.currentTabIndex == 2">
                    <div style="height: 300px">
                        <waltz-logical-flow-table flows="$ctrl.flows"
                                                  decorators="$ctrl.decorators"
                                                  on-initialise="$ctrl.onTableInitialise">
                        </waltz-logical-flow-table>
                    </div>
                </div>

                <div ng-if="$ctrl.filteredFlowData.flows.length == 0 && $ctrl.flows.length > 0">
                    <div class="alert alert-warning">
                        <strong>No data to show</strong> given the current filter options.  Use the
                        configure button above to adjust these options.
                    </div>
                </div>

            </uib-tab>


        </uib-tabset>
    </div>
</div>

<script type="text/ng-template"
        id="wlft-summary-popup.html">
    <div class="small">
        <strong ng-bind="summary.title"></strong>

        <table class="table table-condensed small" style="margin-top: 0.4em">
            <tr ng-repeat="d in summary.summary">
                <td>
                    <span ng-bind="d.key"></span>
                </td>
                <td><span ng-bind="d.count"></span></td>
            </tr>
        </table>
    </div>

</script>